<!DOCTYPE html>
<html>
<head>
  <title>SmartBunks Attendance Calculator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link
    rel="stylesheet"
    href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
  />
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="/static/data/style/style.css">

</head>
<body> 
<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark fixed-top py-3 px-4">
  <div class="container-fluid">
    <a class="navbar-brand fw-bold" href="/">SmartBunks</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="/" data-section="home">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/input" data-section="headform">Form</a>
        </li>
        <li class="nav-item">
            <a href="#col-gap" class="nav-link">Summary</a>
        </li>
      </ul>
    </div>
  </div>
</nav>



<!--Landing/Hero Section -->
<section class="hero-section d-flex align-items-center" id="home">


  <div class="container text-white text-center text-lg-start">
    <div class="row align-items-center">
      <div class="col-lg-6">
        <h1 class="display-4 fw-bold mb-3" id="sb">SmartBunks</h1>
        <p class="lead mb-4">Plan your leaves smartly. Stay above your attendance threshold.</p>
        <a href="/input" class="btn btn-success btn-lg">Letâ€™s Bunk!</a>

         <a href="#col-gap" class="colbtn"><button class="btn colbtn mb-4 btn-outline-info btn-sm" type="button" data-bs-toggle="collapse" data-bs-target="#workingCollapse" aria-expanded="false" aria-controls="workingCollapse">
      ðŸ“˜ Understand the working
    </button></a>

        <!-- <div class="mt-4 d-flex justify-content-center justify-content-lg-start gap-3">
          <a href="#headform" class="text-white text-decoration-none small">Explore Features</a>
          <a href="#attendance-summary" class="text-white text-decoration-none small">View Summary</a>
        </div> -->
      </div>
<div class="col-lg-6 text-center">
        <img src="/static/data/images/herosec.png" alt="Attendance Illustration" class="herosec img-fluid rounded shadow" style="max-height: 400px;" />
     

<!-- Collapse Content -->
 <div id="col-gap" style="margin-bottom: +50px;"><br></div><br>
    <div class="collapse" id="workingCollapse">
      <div class="card card-body collapsible-dark-card  text-start mx-auto" style="max-width: 700px; margin-top: +20px;">
        <p class="mb-3 fw-lighter ">
          Just input your weekly timetable (which subjects you have on each weekday), select your session's start and end dates, and set the attendance threshold (e.g., 75%). SmartBunks will instantly calculate:
        </p>
        <ul class="list-unstyled mb-4 fw-light">
          <li>Total number of classes expected in the session per subject</li>
          <li>Minimum required attendance to stay above the threshold</li>
          <li>Maximum number of leaves you can safely take</li>
        </ul>

        <hr>

        <p><b>Example:</b></p>
        <p>
          Letâ€™s say you select a session from <b>August 1 to November 30</b>, with a <b>75% attendance threshold</b>.<br>
          <br>SmartBunks calculates that you'll have <b>40 lectures of Subject X</b> during this period.
        </p>
        <p>
          To maintain 75% attendance, you need to attend at least <b>30 lectures</b>. So, you can take up to <b>10 leaves</b>.
        </p>
        <p>
          If you've already taken <b>4 leaves</b>, youâ€™re left with <b>6 more safe leaves</b> for that subject.
        </p>
        <p class="mb-0">
          This helps you plan your future leaves without risking attendance shortages!
        </p>
      </div>
    </div>
      </div>
      </div>
    </div>
</section>






  <footer class="text-center py-3 mt-5 border-top" style="font-size: 0.95rem; color: #666;">
    SmartBunks by <strong>Anshuman</strong>
  </footer>

  
  <script>  
  // Auto-scroll to summary 
  window.addEventListener('DOMContentLoaded', function () {
    const summary = document.getElementById('attendance-summary');
    if (summary) {
      summary.scrollIntoView({ behavior: 'smooth' });
    }
  });

  // JS saving form inputs 
    window.addEventListener('beforeunload', function () {
      const formElements = document.querySelectorAll('input, textarea');
      formElements.forEach(el => {
        if (el.type !== 'file') {
          localStorage.setItem(el.name || el.id, el.value);
        }
      });
    });

    window.addEventListener('DOMContentLoaded', function () {
      const wasRestored = localStorage.getItem('wasRestored');
      if (!wasRestored) {
        const formElements = document.querySelectorAll('input, textarea');
        formElements.forEach(el => {
          if (el.type !== 'file') {
            const stored = localStorage.getItem(el.name || el.id);
            if (stored) el.value = stored;
          }
        });
        localStorage.setItem('wasRestored', 'true');
      } else {
        const keysToKeep = ['wasRestored'];
        Object.keys(localStorage).forEach(key => {
          if (!keysToKeep.includes(key)) {
            localStorage.removeItem(key);
          }
        });
        localStorage.removeItem('wasRestored');
      }
    });
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  {% if auto_scroll %}
<script>
  window.addEventListener("load", () => {
      const el = document.getElementById("attendance-summary");
      if (el) el.scrollIntoView({behavior: "auto"});
  });
</script>
{% endif %}
<script>
  // Activate nav items
  document.addEventListener("DOMContentLoaded", function () {
    const navLinks = document.querySelectorAll(".navbar-nav .nav-link");

    navLinks.forEach(link => {
      link.addEventListener("click", function () {
        navLinks.forEach(l => l.classList.remove("active")); // Remove from all
        this.classList.add("active"); // Add to clicked
      });
    });
  });
</script>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const sections = document.querySelectorAll('#home, #headform, #attendance-summary');
    const navLinks = document.querySelectorAll('.nav-link[data-section]');

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          const id = entry.target.getAttribute('id');
          navLinks.forEach(link => {
            link.classList.toggle('active', link.getAttribute('data-section') === id);
          });
        }
      });
    }, {
      rootMargin: '-50% 0px -50% 0px',
      threshold: 0.5
    });

    sections.forEach(section => {
      if (section) observer.observe(section);
    });
  });
</script>

<script>
  document.addEventListener("click", function (event) {
    const navbarToggler = document.querySelector(".navbar-toggler");
    const navbarCollapse = document.querySelector(".navbar-collapse");

    const isClickInside = navbarCollapse.contains(event.target) || navbarToggler.contains(event.target);
    const isExpanded = navbarToggler.getAttribute("aria-expanded") === "true";

    if (!isClickInside && isExpanded) {
      navbarToggler.click(); // Programmatically collapse it
    }
  });
</script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const collapseBtn = document.querySelector(".colbtn button");
    const collapseTarget = document.getElementById("workingCollapse");
    const heroSection = document.getElementById("home");

    collapseTarget.addEventListener("hidden.bs.collapse", function () {
      //scroll back to top section
      heroSection.scrollIntoView({ behavior: "smooth" });
    });
  });
</script>

<script>
  document.addEventListener("click", function (event) {
    const collapse = document.getElementById("workingCollapse");
    const button = document.querySelector(".colbtn button");

    const isClickInsideCollapse = collapse.contains(event.target);
    const isClickOnButton = button.contains(event.target);

    // If click is outside both collapse and button, and collapse is open
    if (!isClickInsideCollapse && !isClickOnButton && collapse.classList.contains("show")) {
      const bsCollapse = bootstrap.Collapse.getInstance(collapse);
      if (bsCollapse) {
        bsCollapse.hide(); // Collapse it
      }
    }
  });
</script>




</body>
</html>